"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.isInMpWebView = exports.isMp = void 0;
function isMp() {
    if (typeof globalThis === 'undefined') {
        return false;
    }
    var wx = globalThis.wx;
    if (typeof wx === 'undefined') {
        return false;
    }
    if (globalThis.Page === undefined) {
        return false;
    }
    if (!wx.getDeviceInfo) {
        return false;
    }
    if (!wx.getStorageSync) {
        return false;
    }
    if (!wx.setStorageSync) {
        return false;
    }
    if (!wx.connectSocket) {
        return false;
    }
    if (!wx.request) {
        return false;
    }
    try {
        if (!wx.getDeviceInfo()) {
            return false;
        }
        if (wx.getDeviceInfo().platform === 'qq') {
            return false;
        }
    }
    catch (e) {
        return false;
    }
    return true;
}
exports.isMp = isMp;
var IS_IN_MP_WEBVIEW = false;
function ready() {
    IS_IN_MP_WEBVIEW = IS_IN_MP_WEBVIEW || (typeof window !== undefined && window.__wxjs_environment === 'miniprogram');
}
try {
    if (!isMp()) {
        IS_IN_MP_WEBVIEW = IS_IN_MP_WEBVIEW
            || !!navigator.userAgent.match(/miniprogram/i)
            || window.__wxjs_environment === 'miniprogram';
        if (window && window.WeixinJSBridge && window.WeixinJSBridge.invoke) {
            ready();
        }
        else if (typeof document !== 'undefined') {
            document.addEventListener('WeixinJSBridgeReady', ready, false);
        }
    }
}
catch (e) { }
function isInMpWebView() {
    return IS_IN_MP_WEBVIEW;
}
exports.isInMpWebView = isInMpWebView;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibXAuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi8uLi9zcmMvdXRpbHMvbXAudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7O0FBQUEsU0FBZ0IsSUFBSTtJQUNsQixJQUFJLE9BQU8sVUFBVSxLQUFLLFdBQVcsRUFBRTtRQUNyQyxPQUFPLEtBQUssQ0FBQTtLQUNiO0lBRU8sSUFBQSxFQUFFLEdBQUssVUFBaUIsR0FBdEIsQ0FBc0I7SUFDaEMsSUFBSSxPQUFPLEVBQUUsS0FBSyxXQUFXLEVBQUU7UUFDN0IsT0FBTyxLQUFLLENBQUE7S0FDYjtJQUNELElBQUssVUFBa0IsQ0FBQyxJQUFJLEtBQUssU0FBUyxFQUFFO1FBQzFDLE9BQU8sS0FBSyxDQUFBO0tBQ2I7SUFDRCxJQUFJLENBQUMsRUFBRSxDQUFDLGFBQWEsRUFBRTtRQUNyQixPQUFPLEtBQUssQ0FBQTtLQUNiO0lBQ0QsSUFBSSxDQUFDLEVBQUUsQ0FBQyxjQUFjLEVBQUU7UUFDdEIsT0FBTyxLQUFLLENBQUE7S0FDYjtJQUNELElBQUksQ0FBQyxFQUFFLENBQUMsY0FBYyxFQUFFO1FBQ3RCLE9BQU8sS0FBSyxDQUFBO0tBQ2I7SUFDRCxJQUFJLENBQUMsRUFBRSxDQUFDLGFBQWEsRUFBRTtRQUNyQixPQUFPLEtBQUssQ0FBQTtLQUNiO0lBQ0QsSUFBSSxDQUFDLEVBQUUsQ0FBQyxPQUFPLEVBQUU7UUFDZixPQUFPLEtBQUssQ0FBQTtLQUNiO0lBRUQsSUFBSTtRQUNGLElBQUksQ0FBQyxFQUFFLENBQUMsYUFBYSxFQUFFLEVBQUU7WUFDdkIsT0FBTyxLQUFLLENBQUE7U0FDYjtRQUVELElBQUksRUFBRSxDQUFDLGFBQWEsRUFBRSxDQUFDLFFBQVEsS0FBSyxJQUFJLEVBQUU7WUFDeEMsT0FBTyxLQUFLLENBQUE7U0FDYjtLQUNGO0lBQUMsT0FBTyxDQUFDLEVBQUU7UUFDVixPQUFPLEtBQUssQ0FBQTtLQUNiO0lBRUQsT0FBTyxJQUFJLENBQUE7QUFDYixDQUFDO0FBekNELG9CQXlDQztBQUVELElBQUksZ0JBQWdCLEdBQUcsS0FBSyxDQUFBO0FBQzVCLFNBQVMsS0FBSztJQUNaLGdCQUFnQixHQUFNLGdCQUFnQixJQUFJLENBQUMsT0FBTyxNQUFNLEtBQUssU0FBUyxJQUFLLE1BQWMsQ0FBQyxrQkFBa0IsS0FBSyxhQUFhLENBQUMsQ0FBQTtBQUNqSSxDQUFDO0FBQ0QsSUFBSTtJQUNGLElBQUksQ0FBQyxJQUFJLEVBQUUsRUFBRTtRQUNYLGdCQUFnQixHQUFRLGdCQUFnQjtlQUNuQyxDQUFDLENBQUMsU0FBUyxDQUFDLFNBQVMsQ0FBQyxLQUFLLENBQUMsY0FBYyxDQUFDO2VBQzFDLE1BQWMsQ0FBQyxrQkFBa0IsS0FBSyxhQUFhLENBQUE7UUFDekQsSUFBSyxNQUFjLElBQUssTUFBYyxDQUFDLGNBQWMsSUFBSyxNQUFjLENBQUMsY0FBYyxDQUFDLE1BQU0sRUFBRTtZQUM5RixLQUFLLEVBQUUsQ0FBQTtTQUNSO2FBQU0sSUFBSSxPQUFPLFFBQVEsS0FBSyxXQUFXLEVBQUU7WUFDMUMsUUFBUSxDQUFDLGdCQUFnQixDQUFDLHFCQUFxQixFQUFFLEtBQUssRUFBRSxLQUFLLENBQUMsQ0FBQTtTQUMvRDtLQUNGO0NBQ0Y7QUFBQyxPQUFPLENBQUMsRUFBRSxHQUFFO0FBQ2QsU0FBZ0IsYUFBYTtJQUMzQixPQUFPLGdCQUFnQixDQUFBO0FBQ3pCLENBQUM7QUFGRCxzQ0FFQyIsInNvdXJjZXNDb250ZW50IjpbImV4cG9ydCBmdW5jdGlvbiBpc01wKCkge1xuICBpZiAodHlwZW9mIGdsb2JhbFRoaXMgPT09ICd1bmRlZmluZWQnKSB7XG4gICAgcmV0dXJuIGZhbHNlXG4gIH1cblxuICBjb25zdCB7IHd4IH0gPSBnbG9iYWxUaGlzIGFzIGFueVxuICBpZiAodHlwZW9mIHd4ID09PSAndW5kZWZpbmVkJykge1xuICAgIHJldHVybiBmYWxzZVxuICB9XG4gIGlmICgoZ2xvYmFsVGhpcyBhcyBhbnkpLlBhZ2UgPT09IHVuZGVmaW5lZCkge1xuICAgIHJldHVybiBmYWxzZVxuICB9XG4gIGlmICghd3guZ2V0RGV2aWNlSW5mbykge1xuICAgIHJldHVybiBmYWxzZVxuICB9XG4gIGlmICghd3guZ2V0U3RvcmFnZVN5bmMpIHtcbiAgICByZXR1cm4gZmFsc2VcbiAgfVxuICBpZiAoIXd4LnNldFN0b3JhZ2VTeW5jKSB7XG4gICAgcmV0dXJuIGZhbHNlXG4gIH1cbiAgaWYgKCF3eC5jb25uZWN0U29ja2V0KSB7XG4gICAgcmV0dXJuIGZhbHNlXG4gIH1cbiAgaWYgKCF3eC5yZXF1ZXN0KSB7XG4gICAgcmV0dXJuIGZhbHNlXG4gIH1cblxuICB0cnkge1xuICAgIGlmICghd3guZ2V0RGV2aWNlSW5mbygpKSB7XG4gICAgICByZXR1cm4gZmFsc2VcbiAgICB9XG5cbiAgICBpZiAod3guZ2V0RGV2aWNlSW5mbygpLnBsYXRmb3JtID09PSAncXEnKSB7XG4gICAgICByZXR1cm4gZmFsc2VcbiAgICB9XG4gIH0gY2F0Y2ggKGUpIHtcbiAgICByZXR1cm4gZmFsc2VcbiAgfVxuXG4gIHJldHVybiB0cnVlXG59XG5cbmxldCBJU19JTl9NUF9XRUJWSUVXID0gZmFsc2VcbmZ1bmN0aW9uIHJlYWR5KCkge1xuICBJU19JTl9NUF9XRUJWSUVXID0gICAgSVNfSU5fTVBfV0VCVklFVyB8fCAodHlwZW9mIHdpbmRvdyAhPT0gdW5kZWZpbmVkICYmICh3aW5kb3cgYXMgYW55KS5fX3d4anNfZW52aXJvbm1lbnQgPT09ICdtaW5pcHJvZ3JhbScpXG59XG50cnkge1xuICBpZiAoIWlzTXAoKSkge1xuICAgIElTX0lOX01QX1dFQlZJRVcgPSAgICAgIElTX0lOX01QX1dFQlZJRVdcbiAgICAgIHx8ICEhbmF2aWdhdG9yLnVzZXJBZ2VudC5tYXRjaCgvbWluaXByb2dyYW0vaSlcbiAgICAgIHx8ICh3aW5kb3cgYXMgYW55KS5fX3d4anNfZW52aXJvbm1lbnQgPT09ICdtaW5pcHJvZ3JhbSdcbiAgICBpZiAoKHdpbmRvdyBhcyBhbnkpICYmICh3aW5kb3cgYXMgYW55KS5XZWl4aW5KU0JyaWRnZSAmJiAod2luZG93IGFzIGFueSkuV2VpeGluSlNCcmlkZ2UuaW52b2tlKSB7XG4gICAgICByZWFkeSgpXG4gICAgfSBlbHNlIGlmICh0eXBlb2YgZG9jdW1lbnQgIT09ICd1bmRlZmluZWQnKSB7XG4gICAgICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCdXZWl4aW5KU0JyaWRnZVJlYWR5JywgcmVhZHksIGZhbHNlKVxuICAgIH1cbiAgfVxufSBjYXRjaCAoZSkge31cbmV4cG9ydCBmdW5jdGlvbiBpc0luTXBXZWJWaWV3KCkge1xuICByZXR1cm4gSVNfSU5fTVBfV0VCVklFV1xufVxuIl19