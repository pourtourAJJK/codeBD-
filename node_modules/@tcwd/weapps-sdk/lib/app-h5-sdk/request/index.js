import { __assign } from "tslib";
import axios from 'axios';
import { stringify } from 'qs';
var internalRequest = axios.create();
export default function (originParams) {
    if (originParams === void 0) { originParams = {}; }
    var requestConfig = __assign(__assign({}, originParams), { headers: __assign({}, originParams.header) });
    // 针对 x-www-form-urlencoded 类型数据转换
    if (originParams.data && originParams.header) {
        if (originParams.header['Content-Type'] === 'application/x-www-form-urlencoded') {
            requestConfig.data = stringify(originParams.data);
        }
    }
    return internalRequest
        .request(requestConfig)
        .then(function (res) {
        // request 保持与小程序一致
        res.statusCode = res.status;
        delete res.status;
        res.header = res.headers;
        delete res.headers;
        originParams.success && originParams.success(res);
        originParams.complete && originParams.complete(res);
        return res;
    })
        .catch(function (err) {
        originParams.fail && originParams.fail(err);
        originParams.complete && originParams.complete(err);
        return Promise.reject(err);
    });
}
