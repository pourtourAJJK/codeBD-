<!-- 订单详情页面 -->
<view class="order-detail">
  <!-- 订单状态 -->
  <view class="order-status">
    <text class="status-text">{{statusText}}</text>
  </view>
  
  <!-- 收货地址 -->
  <view class="address-section">
    <view class="section-title">收货地址</view>
    <view class="address-content" wx:if="order.address">
      <view class="address-info">
        <view class="user-info">
          <text class="name">{{order.address.name}}</text>
          <text class="phone">{{order.address.phone}}</text>
        </view>
        <view class="address-detail">
          {{order.address.province}}{{order.address.city}}{{order.address.district}}{{order.address.detail}}
        </view>
      </view>
    </view>
  </view>
  
  <!-- 商品列表 -->
  <view class="goods-section">
    <view class="section-title">商品信息</view>
    <view class="goods-list">
      <view class="goods-item" wx:for="{{order.goods}}" wx:key="product_id" wx:for-item="item">
        <image class="goods-image" src="{{item.cover_image || '/assets/images/default-product.png'}}" mode="aspectFill"></image>
        <view class="goods-info">
          <text class="goods-name">{{item.product_name}}</text>
          <text class="goods-spec" wx:if="item.spec">{{item.spec}}</text>
          <view class="goods-price-count">
            <text class="price">¥{{item.priceYuan}}</text>
            <text class="count">x{{item.quantity}}</text>
          </view>
        </view>
      </view>
    </view>
  </view>
  
  <!-- 订单信息 -->
  <view class="order-info-section">
    <view class="section-title">订单信息</view>
    <view class="order-info">
      <!-- 仅展示业务订单号，不显示 Mongo _id -->
      <view class="info-item">
        <text class="label">订单编号</text>
        <text class="value">{{order.orderId}}</text>
      </view>

      <view class="info-item">
        <text class="label">支付方式</text>
        <text class="value">{{order.paymentMethod}}</text>
      </view>
      <view class="info-item">
        <text class="label">下单时间</text>
        <text class="value">{{order.createTimeFmt}}</text>
      </view>
      <view class="info-item" wx:if="order.payTimeFmt">
        <text class="label">支付时间</text>
        <text class="value">{{order.payTimeFmt}}</text>
      </view>
      <!-- 已按需求去掉发货时间与物流信息 -->


    </view>
  </view>
  
  <!-- 价格明细 -->
  <view class="price-section">
    <view class="section-title">价格明细</view>
    <view class="price-info">
      <view class="price-item">
        <text class="label">商品总价</text>
        <text class="value">¥{{order.totalPriceYuan}}</text>
      </view>
      <view class="price-item">
        <text class="label">运费</text>
        <text class="value">¥{{order.shippingFeeYuan}}</text>
      </view>
      <view class="price-item" wx:if="order.discountAmount > 0">
        <text class="label">优惠</text>
        <text class="value discount">-¥{{order.discountAmountYuan}}</text>
      </view>
      <view class="price-item total">
        <text class="label">实付金额</text>
        <text class="value total-value">¥{{order.payAmountYuan}}</text>
      </view>
    </view>
  </view>
  
  <!-- 底部操作按钮：修改地址 / 取消或退款 -->
  <view class="action-buttons" wx:if="{{showActionBar && order}}">
    <view class="pill-group">
      <button class="pill-btn" bindtap="modifyAddress">修改地址</button>
      <button class="pill-btn pill-danger" bindtap="onCancelAction">
        {{order.status === 'paid' ? '申请退款' : '取消订单'}}
      </button>
    </view>
  </view>
  
</view>